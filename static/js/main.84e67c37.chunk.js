(this["webpackJsonpvote-cli"]=this["webpackJsonpvote-cli"]||[]).push([[1],{228:function(t,e,n){},230:function(t,e,n){},242:function(t,e){},264:function(t,e){},266:function(t,e){},280:function(t,e){},281:function(t,e){},283:function(t,e){},284:function(t,e){},384:function(t,e){},386:function(t,e){},392:function(t,e){},394:function(t,e){},407:function(t,e){},424:function(t,e){},437:function(t,e){},518:function(t,e,n){"use strict";n.r(e);var c=n(13),r=n(1),i=n.n(r),a=n(212),o=n.n(a),s=(n(228),n(71)),u=n(7),l=n.n(u),f=n(18),d=(n(230),n(73)),j=n(520),p=n(19),b=n(90),h=n.n(b),v=function(t){var e=Object(r.useState)({web3:new h.a}),n=Object(p.a)(e,2),i=n[0],a=n[1],o=Object(j.g)(),s=o.account,u=o.ethereum,l=Object(r.useCallback)((function(){var t=new h.a(u);a({web3:t})}),[u,a,i]);return Object(r.useEffect)((function(){s&&u&&l()}),[s,u]),Object(c.jsx)(O.Provider,{value:i,children:t.children})},O=Object(r.createContext)({web3:new h.a}),x=n(2),m=n(4),C=n(37),g=n(214),y=n.n(g),k=new(function(){function t(e){Object(x.a)(this,t),this.axios=void 0,this.baseURL=void 0,this.baseURL=e,this.axios=y.a.create({timeout:3e4,headers:{"Content-Type":"application/json;charset=utf-8"},transformRequest:[function(t){return JSON.stringify(t)}],transformResponse:[function(t){return JSON.parse(t)}]}),this.interceptors()}return Object(m.a)(t,[{key:"interceptors",value:function(){this.axios.interceptors.request.use((function(t){return Promise.resolve(t)}),(function(t){return Promise.reject(t)})),this.axios.interceptors.response.use((function(t){var e=t.status,n=t.data,c=n.code,r=n.result;return 200===e&&0===c?Promise.resolve(r):Promise.reject(n)}),(function(t){return Promise.reject(t)}))}},{key:"get",value:function(t,e){return this.axios.get("".concat(this.baseURL).concat(t),{params:Object(C.a)({},e)})}},{key:"post",value:function(t,e){return this.axios.post("".concat(this.baseURL).concat(t),e)}},{key:"put",value:function(t,e){return this.axios.put(t,e)}},{key:"patch",value:function(t,e){return this.axios.patch(t,e)}},{key:"delete",value:function(t){return this.axios.delete(t)}}]),t}())("http://120.79.189.25:32088/"),w=function(){function t(){Object(x.a)(this,t)}return Object(m.a)(t,null,[{key:"vote",value:function(t,e){return k.post("vote/vote",{msgParams:t,result:e})}},{key:"product",value:function(t){return k.post("vote/product",{address:t})}}]),t}();function P(){var t=Object(s.a)(["\n    height: 100vh;\n    width: 600px;\n    margin: 0 auto;\n    display: flex;\n    justify-content: center;\n    align-content: center;\n    align-items: center;\n    flex-flow: column;\n    ","\n\n.list{\ndisplay: flex;\nalign-items: center;\nwidth: 100%;\np{\nflex: 1;\n}\n}\n.ac{\np{\ncolor: green;\n}\n}\n"]);return P=function(){return t},t}function R(){var t=Object(s.a)(["\n\ncolor: ",";\n"]);return R=function(){return t},t}var _,S=function(){var t=function(){var t=Object(r.useContext)(O).web3,e=Object(j.g)().account;return Object(r.useCallback)((function(n,c){var r=e,i=[r,JSON.stringify(c)];t.currentProvider.sendAsync({method:"eth_signTypedData_v4",params:i,from:r},(function(t,e){if(console.log(t),t)return console.dir(t);if(e.error&&alert(e.error.message),e.error)throw"ERROR";n(e.result)}))}),[t,e])}(),e=Object(r.useState)({data:void 0,result:void 0}),n=Object(p.a)(e,2),i=n[0],a=n[1],o=function(){var t=Object(r.useState)({list:[],ac:{}}),e=Object(p.a)(t,2),n=e[0],c=e[1],i=Object(j.g)().account,a=Object(r.useCallback)(Object(f.a)(l.a.mark((function t(){var e;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,w.product(i);case 3:e=t.sent,c(e),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),c(t.t0);case 10:case"end":return t.stop()}}),t,null,[[0,7]])}))),[c,i]);return Object(r.useEffect)((function(){a()}),[]),[n]}(),s=Object(p.a)(o,1)[0];return Object(c.jsxs)(E,{children:[Object(c.jsxs)("div",{className:"list",children:[Object(c.jsx)("p",{children:"\u9879\u76eeID"}),Object(c.jsx)("p",{children:"\u9879\u76ee\u4ecb\u7ecd:"}),Object(c.jsx)("p",{children:"\u83b7\u53d6\u603b\u6295\u7968"}),Object(c.jsx)("p",{children:" "})]}),s.list?Object(c.jsx)(c.Fragment,{children:s.list.map((function(e){return Object(c.jsxs)("div",{className:"list ".concat(s.ac.product_id===e.product_id?"ac":""),onClick:function(){var n=function(t){return{domain:{chainId:1,name:"nsuer",verifyingContract:"0xCcCCccccCCCCcCCCCCCcCcCccCcCCCcCcccccccC",version:"4"},message:{contents:"vote",product:t},primaryType:"Mail",types:{EIP712Domain:[{name:"name",type:"string"},{name:"version",type:"string"}],Mail:[{name:"contents",type:"string"},{name:"product",type:"string"}]}}}(e.product_id);t((function(t){a({result:t,data:n})}),n)},children:[Object(c.jsx)("p",{children:e.product_id}),Object(c.jsx)("p",{children:e.msg}),Object(c.jsx)("p",{children:e.quantity}),Object(c.jsx)("p",{children:s.ac.product_id===e.product_id?"\u5df2\u6295 ".concat(s.ac.quantity,"\u7968"):"\u4e3a\u6b64\u9879\u76ee\u7b7e\u540d"})]},e.product_id)}))}):Object(c.jsx)("div",{children:"\u65e0\u6570\u636e"}),Object(c.jsx)("div",{style:{height:"100px"},children:"---"}),Object(c.jsx)("div",{onClick:Object(f.a)(l.a.mark((function t(){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,w.vote(i.data,i.result);case 3:t.sent,t.next=9;break;case 6:t.prev=6,t.t0=t.catch(0),alert(t.t0.err);case 9:case"end":return t.stop()}}),t,null,[[0,6]])}))),children:"\u6295\u7968"})]})},E=d.b.div(P(),(_="red",Object(d.a)(R(),_)));function I(){var t=Object(s.a)([""]);return I=function(){return t},t}var J=function(){return Object(c.jsx)(j.a,{chainId:1,connectors:{walletconnect:{rpcUrl:"https://mainnet.infura.io/v3/a17d484065334e38bd8b6475ca266c88"}},children:Object(c.jsx)(v,{children:Object(c.jsx)(N,{})})})},N=function(){var t=Object(j.g)(),e=t.account,n=t.connect;return Object(r.useEffect)((function(){console.log(e)})),Object(c.jsx)(U,{children:e?Object(c.jsx)(S,{}):Object(c.jsx)("p",{onClick:Object(f.a)(l.a.mark((function t(){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n("injected");case 2:t.sent;case 3:case"end":return t.stop()}}),t)}))),children:"\u9700\u8981\u6388\u6743"})})},U=d.b.div(I());o.a.render(Object(c.jsx)(i.a.StrictMode,{children:Object(c.jsx)(J,{})}),document.getElementById("root"))}},[[518,2,3]]]);
//# sourceMappingURL=main.84e67c37.chunk.js.map